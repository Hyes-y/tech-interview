# 자바스크립트 제어 흐름

## 제어 흐름 간의 차이

| 동기적 제어 흐름                                                                 | 비동기적 제어 흐름                                                      |
| -------------------------------------------------------------------------------- | ----------------------------------------------------------------------- |
| 현재 실행 중인 코드가 종료되기 전까지 다음 줄의 코드를 실행하지 않는 것          | 현재 실행 중인 코드가 종료되기 전에 다음 라인의 코드를 실행하는 것      |
| 분기문, 반복문, 함수 호출 등이 동기적으로 실행                                   | Promise, callback 함수를 호출하는 함수 등은 비동기적으로 실행           |
| 코드의 흐름과 실제 제어 흐름이 동일                                              | 코드의 흐름과 실제 제어 흐름이 상이                                     |
| 싱글 스레드 환경에서 메인 스레드가 긴 시간 점유하면 프로그램을 멈추게 한다       | 비동기 작업을 기다리는 동안 메인 스레드는 다른 작업을 진행              |
| A-B-C(해야할 일) <br> 사용자 요청>A 실행>A 반환>B 실행>B 반환>C 실행>데이터 반환 | A-B-C(해야할 일) <br> 사용자 요청>A, B, C 실행>A, B, C 반환>데이터 반환 |

## 자바스크립트 엔진

하나의 메인 스레드로 구성
메인 스레드는 코드를 읽어 한 줄씩 실행, 즉 비동기 처리를 제공하지 않는다.
cf. Java, C++: 멀티스레드 언어

## 자바스크립트는 왜 비동기식으로 하는가?

비동기로 하면 로그인과 동시에 이후 작업들을 미리 수행할 수 있어 빠른 응답이 가능하다.

자바스크립트 엔진은 비동기 처리를 제공하지 않아서 `비동기 코드`를 활용한다, 이런 함수들을 API라고 한다.

비동기 API(web API) ex. setTimeout, XMLHttpRequest, fetch

### 비동기 처리 모델

비동기 코드 호출 시 비동기 환경에서 Task queue(setTimeout)와 Job queue(promiseAPI 또는 animation frame)가 사용된다
`비동기 코드를 처리하는 모듈은 자바스크립트 엔진 외부에 있다`
API 모듈은 비동기 요청을 처리 후 task queue에 콜백 함수를 넣는다

## 비동기식 제어의 문제점

한꺼번에 처리하기 때문에 순차적으로 처리되어 반환하는 과정이 필요한 경우 다루기가 힘들어진다.
비동기 코드를 동기 코드처럼 간결하게 작성하게 해주기 위해 `async/await`을 활용한다.
